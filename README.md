=====

# 🎨 Python Screensaver

PythonとPygameで作成された、多機能なカスタマイズ可能スクリーンセーバーです。  
4つの異なる表示モード、物理演算や花火エフェクト、詳細な設定GUI、そして強力なパスワード保護と**カメラ監視機能**を備えています。  

---

## ✨ 主な機能

- **多彩なセーバーモード**:  
  - **ボール**: 色とりどりのボールが画面を跳ね回ります。  
    - ボール同士はリアルな物理演算に基づいて衝突します。  
    - 壁やボール同士の衝突で、カスタマイズ可能な**花火エフェクト**が飛び散ります（色はボール連動/虹色から選択可）。  
  - **スライドショー**: 指定したフォルダ内の画像をクロスフェード効果付きで表示します。  
  - **ラインアート**: 複数の線が画面内を滑らかに動き回ります。  
  - **マトリックス**: 画面上部から緑色の文字が雨のように降り注ぎます。  
- **直感的な設定GUI**:  
  - Tkinter製のGUIで、すべての設定を簡単に行えます。  
  - 設定の変更をリアルタイムで確認できる**プレビュー機能**付き。  
  - GUIのテーマ（デザイン）を変更できます（OSにより利用可能なテーマは異なります）。  
- **強力なパスワード保護**:  
  - スクリーンセーバーからの復帰時にパスワードを要求し、入力UIの表示位置（中央/上/下）やデザインも設定可能です。  
  - **警告**: パスワードを3回間違えると、セキュリティのためPCが**強制的にシャットダウン**されます。  
    - この際、**Webカメラで撮影**を試みます（カメラ監視有効時）。  
  - 設定画面を開く際にもパスワード認証を要求できます。  
  - 復帰時にパスワードを入力後、スクリーンセーバーを継続するか、プログラムを終了するかを選択できます。  
- **カメラによるセキュリティ監視 (要Webカメラ)**:  
  - スクリーンセーバー実行中に、Webカメラで動きを検知して自動で静止画を撮影します。  
  - 撮影した画像はタイムスタンプ付きで指定フォルダに保存されます。  
  - 古いキャプチャ画像を自動で削除する機能も備えています。  
- **安全な設定管理**:  
  - 設定は `settings.json` ファイルに保存されます。  
  - Windows環境では、DPAPIを利用して設定ファイルが**自動的に暗号化**され、安全に保護されます。  
  - 設定ファイルの破損に備え、自動でバックアップファイル (`settings.json.bak`) を作成・復元します。  
- **バックグラウンド動作**:  
  - 起動後はシステムトレイに常駐し、PCの無操作状態を監視します。  
  - Windows環境では、無操作時間が設定値を超えると自動でスクリーンセーバーを再開するオプションがあります。  
  - トレイアイコンからいつでも安全にプログラムを終了できます。  
- **便利な情報表示**:  
  - スクリーンセーバー中に現在時刻を表示できます（位置・色・サイズも変更可能）。  
  - バッテリー駆動のデバイスでは、現在のバッテリー残量と状態を表示します（Windowsのみ）。  
 
---  

## ⚙️ 動作環境  

- **OS**: Windows / Linux / macOS  
  - *一部機能（設定ファイルの暗号化、バッテリー表示、無操作時の自動再開、カメラデバイスの自動検出）はWindows限定です。*  
- **Python**: 3.6以上  

### 必要なライブラリ  

このプログラムを実行するには、以下のライブラリが必要です。

```bash  
pip install pygame Pillow pystray psutil opencv-python  
```  

Windowsユーザーの場合は、追加で `pywin32` もインストールしてください。

```bash  
pip install pywin32  
```

---
### exe形式にしたいときのコマンド  

⚠️ 管理者権限で起動させると強制終了します😱

```bash  
pyinstaller --onefile --noconsole --icon=icon.ico screensaver.py  
```

---

## 🚀 使い方  

### 1. 起動と設定  

以下のコマンドで設定GUIを起動します。 

```bash  
python screensaver.py
```

GUI画面で各種設定を行います。  

- **モード選択**: 4つの表示モードから好みのものを選択します。  
- **各モードの設定**: ボールの数や速度、スライドショーの画像フォルダなど、選択したモードに応じた詳細設定を行います。  
- **時刻表示設定**: 時刻表示の有無、表示位置、フォントサイズ、色をカスタマイズします。  
- **パスワード保護**: 第三者に勝手に触れられることを防ぐため、パスワードを有効にし、任意のパスワードを設定します。  
**この機能を有効にする際は、シャットダウンのリスクを十分に理解してください。**  

設定完了後、「**スクリーンセーバー開始**」ボタンを押してください。  
プログラムがシステムトレイに格納され、バックグラウンドで無操作状態の監視を開始します。  

### 2. パスワード設定時における終了方法

プログラムを完全に終了するには、システムトレイにあるアイコンを右クリックし、「**完全に終了**」を選択してください。  

---

## ⚠️ 注意事項

- **強制シャットダウン機能**: パスワード保護を有効にしている場合、パスワードの入力に3回失敗すると、**いかなる作業中でもPCが強制的にシャットダウンされます**。    
この機能は自己責任でご利用ください。使用する際はあらかじめデータの保存をお願いします。  
- **管理者権限**: LinuxやmacOSでシャットダウン機能を正常に動作させるには、スクリプトを `sudo` 経由で実行する必要がある場合があります。  
- **フォント**: UIや時刻表示には、日本語フォントとして `meiryo` を優先的に使用しようとします。  
このフォントがインストールされていない環境では、表示が崩れる可能性があります。  
- **プレビュー**: 設定画面のプレビューは、実際の動作を簡易的に表現したものです。実際の表示とは若干異なる場合があります。  
- スライドショーモード以外でディスプレイを長時間眺めていた場合、一時的に身体に不調を来たすことがあるので注意が必要です。  

---

## その他
- icoはオマケで用意しているため、コードの内容とは無関係です。

---

## 修正一覧  
- 2025.09.11    
1. パスワード未設定で稼働させると、スクリーンセーバー自体の解除・終了が出来なかった事象を修正   
2. パスワード設定状態から解除させるとプログラムが終了せず、待機・監視モードが継続されてしまう  
   待機・監視モードからタスクトレイ経由で完全に終了させると待機・監視モードが継続されてしまう事象を修正

- 2025.09.12  
パフォーマンス改善のための修正
   
---

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。 

=====
